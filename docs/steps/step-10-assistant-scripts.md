### Шаг 10: Assistant — Scripts (моки, формы, валидация, локальное состояние)

- Цель:
  - Реализовать экран скриптов (правила событий и действий) с локальными мок‑данными и валидацией.
  - Сохранять изменения в модель риверпода (провайдер состояния по assistantId).

- Действия:
  0) Структура кода (обязательно)
  - Соблюдать модульную структуру подфичи: `features/assistant/features/scripts/{models,providers,widgets,screens}/`.
  - Экран(ы) — только композиция; редакторы/диалоги/конструктор правил — в `widgets/`; модели — в `models/`; провайдеры — в `providers/`.

  1) Модель и провайдеры
  - Тип `ScriptRule` (ограниченно, без сложной оркестрации):
    - id: string (UUID)
    - enabled: boolean
    - event: enum("on_enter_dialog", "on_leave_dialog", "on_trigger")
    - trigger?: { name: string, params: map<string, any> } (для on_trigger)
    - actions: Action[] (последовательность)
  - Тип `Action` (упрощённый перечень):
    - type: enum("say", "transfer_call", "hangup", "set_variable")
    - params: map<string, any>
      - say: { text: string }
      - transfer_call: { employee_extension: string, farewell_phrase?: string }
      - hangup: { farewell_phrase?: string }
      - set_variable: { key: string, value: string }
  - Провайдер: список правил по assistantId, CRUD: add/update/remove, toggle.

  2) Экран UI (Scripts)
  - Список правил: теги события, краткое описание действий, переключатель enabled.
  - Редактор правила:
    - Поля: event (select), trigger (если event == on_trigger), конструктор списка actions (добавить/удалить/редактировать).
    - Для действий использовать формы по типу, валидация обязательных полей.
  - UX: редактор в диалоге/отдельной странице; предпросмотр человека‑читаемого описания правила.

  3) Валидация
  - event: обязателен.
  - on_trigger: name 2–40, params — плоский словарь строковых значений (минимум для шага).
  - actions: ≥ 1; валидация параметров по типу действия.

  4) Сохранение
  - Сохранять правило в провайдер; показывать snackbar об успехе.

- Ожидаемый результат:
  - Конструктор правил с базовыми действиями, локальным сохранением и валидаторами.

- Критерии готовности (Definition of Done):
  - CRUD правил и включение/выключение.
  - Валидация форм действий и событий.
  - Документация обновлена, коммит и push выполнены.

- Тесты (не используются):
  - Ручная проверка сценариев on_enter/on_leave/on_trigger и выполнения последовательности действий (на уровне мока — логировать в консоль/стейт).

- Зависимости/примечания:
  - Полезно согласовать с инструментами из шага 7 (transferCall/hangup).

- Риски:
  - Рост сложности конструктора — на первом шаге ограничиваемся простыми действиями и плоскими параметрами.

Выполнено: в процессе
